<!DOCTYPE html>
<html lang="es">
<script src="https://unpkg.com/wordcloud@1.1.2/src/wordcloud2.js"></script>
<form method="post" action="..." id="form-login">
  <button type="submit" class="btn btn-primary position-relative">
    <span class="spinner-border spinner-border-sm me-2 d-none" role="status" aria-hidden="true"></span>
    <span class="btn-text">Ingresar</span>
  </button>
</form>
<head>
  <meta charset="UTF-8">
  <title>{% block title %}TP3{% endblock %}</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
</head>
<body class="p-4">
  <nav class="mb-4">
    {% if session.get('username') %}
      <a href="{{ url_for('home') }}">Inicio</a> |
      <a href="{{ url_for('nuevo_reclamo') }}">Nuevo Reclamo</a> |
      <a href="{{ url_for('listar_reclamos') }}">Ver Reclamos</a> |
      <a href="{{ url_for('logout') }}">Salir</a>
    {% else %}
      <a href="{{ url_for('index') }}">Login</a> |
      <a href="{{ url_for('registro') }}">Registro</a>
    {% endif %}
  </nav>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for cat, msg in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
      {{ msg }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {% endfor %}
{% endwith %}

  {% block content %}{% endblock %}
</body>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Para cada formulario, cuando se envíe…
    document.querySelectorAll("form").forEach(form => {
      form.addEventListener("submit", () => {
        const btn = form.querySelector("button[type=submit]");
        if (!btn) return;
        // Ocultar el texto y mostrar spinner
        const spinner = btn.querySelector(".spinner-border");
        const label   = btn.querySelector(".btn-text");
        btn.disabled = true;           // deshabilitar para evitar dobles clicks
        if (label) label.classList.add("visually-hidden");
        if (spinner) spinner.classList.remove("d-none");
      });
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Auto-dismiss de alerts tras 5s
    setTimeout(() => {
      document.querySelectorAll(".alert").forEach(alertEl => {
        // Usa la API de bootstrap para cerrar
        const bsAlert = bootstrap.Alert.getOrCreateInstance(alertEl);
        bsAlert.close();
      });
    }, 5000);
  });
</script>
</html>
